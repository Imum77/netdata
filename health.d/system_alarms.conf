# ========================================
# CPU АЛАРМЫ
# ========================================

alarm: cpu_usage_critical
   on: system.cpu
lookup: average -2m percentage foreach user,system
 units: %
 every: 30s
  crit: $this > 95
 delay: down 0s up 1m
  info: CPU usage is critically high
    to: sysadmin

alarm: cpu_usage_warning
   on: system.cpu
lookup: average -3m percentage foreach user,system
 units: %
 every: 30s
  warn: $this > 80
 delay: down 0s up 2m
  info: CPU usage is high
    to: sysadmin

# ========================================
# RAM АЛАРМЫ
# ========================================

alarm: ram_critical
   on: system.ram
lookup: average -2m percentage foreach available
 units: %
 every: 30s
  crit: $this < 5
 delay: down 0s up 1m
  info: RAM is critically low
    to: sysadmin

alarm: ram_warning
   on: system.ram
lookup: average -3m percentage foreach available
 units: %
 every: 30s
  warn: $this < 15
 delay: down 0s up 2m
  info: RAM is running low
    to: sysadmin

# ========================================
# SWAP АЛАРМЫ
# ========================================

alarm: swap_critical
   on: mem.swap
lookup: average -2m percentage foreach used
 units: %
 every: 30s
  crit: $this > 90
 delay: down 0s up 2m
  info: SWAP usage is critical
    to: sysadmin

alarm: swap_warning
   on: mem.swap
lookup: average -3m percentage foreach used
 units: %
 every: 30s
  warn: $this > 50
 delay: down 0s up 3m
  info: SWAP usage is high
    to: sysadmin

# ========================================
# LOAD AVERAGE АЛАРМЫ
# ========================================

alarm: load_average_critical
   on: system.load
lookup: average -3m
 units: load
 every: 30s
  crit: $this > 10
 delay: down 0s up 1m
  info: System load is critically high
    to: sysadmin

alarm: load_average_warning
   on: system.load
lookup: average -3m
 units: load
 every: 30s
  warn: $this > 5
 delay: down 0s up 2m
  info: System load is high
    to: sysadmin

# ========================================
# DISK АЛАРМЫ
# ========================================

alarm: disk_space_critical
   on: disk.space
lookup: average -1m percentage foreach used
 units: %
 every: 1m
  crit: $this > 95
 delay: down 0s up 5m
  info: Disk space is critically low
    to: sysadmin

alarm: disk_space_warning
   on: disk.space
lookup: average -1m percentage foreach used
 units: %
 every: 1m
  warn: $this > 85
 delay: down 0s up 5m
  info: Disk space is running low
    to: sysadmin

